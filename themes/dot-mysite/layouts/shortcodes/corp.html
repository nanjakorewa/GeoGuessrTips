{{ $_hugo_config := `{ "version": 1 }` }}

{{/* Build path safely */}}
{{ $rpth := path.Join "content" "rule" (.Get 0) (.Get 1) "corp" }}
{{ $clsname := "normal" }}
{{ $langflag := "ja" }}
{{ $areaname := (.Get 0) }}
{{ $regname := (.Get 1) }}

{{- if eq (.Get 2) "small" -}}
  {{ $clsname = "small" }}
{{- else if eq (.Get 2) "verysmall" -}}
  {{ $clsname = "verysmall" }}
{{- else -}}
  {{ $clsname = "normal" }}
{{- end -}}

{{ if ne .Site.Language.Lang "ja" }}
  {{ $langflag = .Site.Language.Lang }}
{{ end }}

<h4 class="section-title corp-desc-dp" style="margin-bottom:0;padding-bottom:0;">{{ i18n "findable-corp-sign" }}</h4>
<p class="corp-desc-dp" style="margin:0;padding:0;font-size:0.8em;">説明は<a href="#corp-desc"><u>ページ下部</u></a>。必ずしも道端で見つかるとは限りません。</p>

<div class="corp-area corp-desc-dp" style="background-color:#fff;border-radius:0.4em;">

  {{/* Only read directory when it exists to avoid errors */}}
  {{ if fileExists $rpth }}
    {{ $files := readDir $rpth }}
    {{ range $files }}
      {{ if eq $langflag "ja" }}
        <img src="./corp/{{ .Name }}" class="{{ $clsname }}"/>
      {{ else }}
        <img src="https://geopinning.space/rule/{{ $areaname }}/{{ $regname }}/corp/{{ .Name }}" class="{{ $clsname }}"/>
      {{ end }}
    {{ end }}
  {{ else }}
    {{/* Optional: show nothing or a fallback note; remove this block if you prefer silence */}}
    <!-- corp directory not found: {{ $rpth }} -->
  {{ end }}

  <div class="corp-area corp-area-clickable">
    {{ if eq (.Get 3) "OGL" }}
      <p><a href="http://nationalarchives.gov.uk/doc/open-government-licence/version/1/">Open Government Licence v1.0(Link)</a></p>
    {{ else if (.Get 3) }}
      <p>{{ .Get 3 }} <a href="{{ .Get 4 }}">Wikimedia Commons(Link)</a></p>
    {{ end }}
  </div>
</div>
